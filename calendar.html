<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Worker Attendance Calendar</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;font-family:'Segoe UI',Tahoma,Verdana,sans-serif;}

body{
  background:linear-gradient(270deg,#ff416c,#ff4b2b,#ff6a00,#fcd800,#0ff0b3,#2196f3,#9c27b0);
  background-size:1400% 1400%;
  animation:rainbow 15s ease infinite;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding:16px;
}
@keyframes rainbow{
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}

.container{
  width:100%;
  max-width:900px;
  min-height:85vh;
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(14px);
  border-radius:20px;
  padding:18px;
  box-shadow:0 10px 30px rgba(0,0,0,.35);
  display:flex;
  flex-direction:column;
  gap:16px;
}

.header{
  display:flex;
  justify-content:center;
}
.workerName{font-size:20px;font-weight:700;color:#fff;}

.salaryBox{
  margin:0 auto;
  width:180px;height:50px;border-radius:25px;
  background:linear-gradient(270deg,#ff416c,#ff4b2b,#ff6a00,#fcd800,#0ff0b3,#2196f3,#9c27b0);
  background-size:1400% 1400%;
  animation:rainbow 8s ease infinite;
  display:flex;justify-content:center;align-items:center;
  font-size:24px;font-weight:700;color:#fff;
}

.infoBar{
  display:flex;justify-content:space-around;
  background:rgba(255,255,255,0.15);
  border-radius:20px;padding:10px;
  color:#fff;font-weight:600;
}

/* Month navigation */
.monthNav{
  display:flex;
  justify-content:space-between;
  align-items:center;
  color:#fff;
}

.monthNav button{
  background:rgba(255,255,255,.25);
  border:none;
  color:#fff;
  padding:8px 14px;
  border-radius:14px;
  font-weight:600;
  cursor:pointer;
}

.calendarMonth{
  font-size:11px;
  font-weight:700;
}

.weekdays{
  display:grid;grid-template-columns:repeat(7,1fr);
  text-align:center;color:#fff;
}

.calendar{
  display:grid;grid-template-columns:repeat(7,1fr);
  gap:6px;justify-items:center;
}

.day{
  width:100%;max-width:48px;aspect-ratio:1;
  border-radius:50%;
  background:rgba(255,255,255,0.25);
  display:flex;justify-content:center;align-items:center;
  font-weight:600;color:#fff;
  cursor:pointer;
}

.day.present{background:rgba(0,200,100,.5);}
.day.absent{background:rgba(255,80,80,.5);}

.bottomButton{
  border:none;background:rgba(255,255,255,.25);
  color:#fff;padding:10px;border-radius:14px;
  cursor:pointer;font-weight:600;
}

/* Dialog */
.dialogOverlay{
  position:fixed;inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  justify-content:center;
  align-items:center;
}

.dialogBox{
  width:90%;
  max-width:320px;
  background:rgba(255,255,255,.25);
  border-radius:20px;
  padding:18px;
  color:#fff;
}

.dialogButtons{display:flex;gap:10px;margin-top:12px;}
.dialogButtons button{
  flex:1;border:none;padding:10px;
  border-radius:12px;font-weight:600;
}
.cancelBtn{background:#d50000;color:#fff;}
.okBtn{background:#00c853;color:#fff;}
</style>
</head>

<body>

<div class="container">
  <div class="header">
    <div class="workerName" id="workerName">Worker</div>
  </div>

  <div class="salaryBox">‚Çπ</div>

  <div class="infoBar">
    <div>Total: <span id="totalDays"></span></div>
    <div>P: <span id="presentCount">0</span></div>
    <div>A: <span id="absentCount">0</span></div>
  </div>

  <!-- Month Navigation -->
  <div class="monthNav">
    <button onclick="changeMonth(-1)">‚óÄ Prev</button>
    <div class="calendarMonth" id="calendarMonth"></div>
    <button onclick="changeMonth(1)">Next ‚ñ∂</button>
  </div>

  <div class="weekdays" id="weekdays"></div>
  <div class="calendar" id="calendar"></div>

  <button class="bottomButton" onclick="history.back()">‚Üê Back</button>
</div>

<!-- Dialog -->
<div class="dialogOverlay" id="dialog">
  <div class="dialogBox">
    <h3>Select Attendance</h3>
    <label><input type="radio" name="att" value="P"> Present</label><br>
    <label><input type="radio" name="att" value="A"> Absent</label><br>
    <label><input type="radio" name="att" value=""> Clear</label>

    <div class="dialogButtons">
      <button class="cancelBtn">Cancel</button>
      <button class="okBtn">OK</button>
    </div>
  </div>
</div>

<script>
const params=new URLSearchParams(location.search);
const worker=params.get("name")||"Worker";
document.getElementById("workerName").innerText=worker;

//const DAILY_SALARY = 500; // üëà PER DAY FIX SALARY
const SALARY_MAP = {
  "Soniya": 1,
  "Mummy": 2,
  "Sanjeeta": 3,
  "Sanjit": 4,
  "Piyush": 5
};





  
const storageKey="attendance_"+worker;
let attendance=JSON.parse(localStorage.getItem(storageKey))||{};

const weekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
const weekdaysDiv=document.getElementById("weekdays");
weekdaysDiv.innerHTML="";
weekdays.forEach(d=>weekdaysDiv.innerHTML+=`<div>${d}</div>`);

let current=new Date();
let year=current.getFullYear();
let month=current.getMonth();

const monthNames=[
"January","February","March","April","May","June",
"July","August","Sept","October","November","December"
];

function renderCalendar(){
  const calendar=document.getElementById("calendar");
  calendar.innerHTML="";

  const daysInMonth=new Date(year,month+1,0).getDate();
  const firstDay=new Date(year,month,1).getDay(); // ‚úÖ FIX

  document.getElementById("totalDays").innerText=daysInMonth;
  document.getElementById("calendarMonth").innerText=
    monthNames[month]+" "+year;

  let presentCount=0;
  let absentCount=0;

  /* üîπ EMPTY CELLS BEFORE 1st DATE */
  for(let i=0;i<firstDay;i++){
    const empty=document.createElement("div");
    empty.style.visibility="hidden";
    calendar.appendChild(empty);
  }

  for(let i=1;i<=daysInMonth;i++){
    const dateKey=`${year}-${String(month+1).padStart(2,"0")}-${String(i).padStart(2,"0")}`;
    const d=document.createElement("div");
    d.className="day";
    d.innerText=i;

    if(attendance[dateKey]==="P"){
      d.classList.add("present");
      presentCount++;
    }
    if(attendance[dateKey]==="A"){
      d.classList.add("absent");
      absentCount++;
    }

    d.onclick=()=>openDialog(dateKey);
    calendar.appendChild(d);
  }

  document.getElementById("presentCount").innerText=presentCount;
  document.getElementById("absentCount").innerText=absentCount;

  /* üí∞ SALARY CALC */
  const totalSalary = presentCount * DAILY_SALARY;
  document.querySelector(".salaryBox").innerText = "‚Çπ " + totalSalary;
}

function changeMonth(step){
  month+=step;
  if(month<0){month=11;year--;}
  if(month>11){month=0;year++;}
  renderCalendar();
}

let selectedDate="";
function openDialog(date){
  selectedDate=date;
  document.getElementById("dialog").style.display="flex";
}

document.querySelector(".cancelBtn").onclick=()=>{
  document.getElementById("dialog").style.display="none";
};

document.querySelector(".okBtn").onclick=()=>{
  const val=document.querySelector("input[name='att']:checked")?.value;
  if(val) attendance[selectedDate]=val;
  else delete attendance[selectedDate];
  localStorage.setItem(storageKey,JSON.stringify(attendance));
  document.getElementById("dialog").style.display="none";
  renderCalendar();
};

renderCalendar();
</script>

</body>
</html>
